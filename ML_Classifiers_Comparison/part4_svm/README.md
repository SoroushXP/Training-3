# بخش ۴: تحلیل ماشین بردار پشتیبان (SVM)

## هدف
بررسی الگوریتم SVM با کرنل‌های مختلف و مقادیر متفاوت پارامتر C.

---

## پاسخ به سوالات تمرین

### نتایج SVM خطی با مقادیر مختلف C

| C | دقت (Accuracy) |
|---|----------------|
| 0.01 | 0.9296 |
| 0.1 | 0.9648 |
| 1 | 0.9759 |
| 10 | 0.9759 |
| 100 | 0.9741 |

### نتایج SVM با کرنل‌های مختلف

| کرنل | بهترین C | دقت (Accuracy) |
|------|----------|----------------|
| Linear | 1 | 0.9759 |
| Polynomial (degree=3) | 10 | **0.9907** |
| RBF | 10 | 0.9889 |

### بهترین مدل
**Kernel: Polynomial (degree=3), C=10** با دقت **0.9907 (99.07%)**

---

### تحلیل اثر پارامتر C روی Margin و Generalization

**C کوچک (مثلاً 0.01):**
- **Margin بزرگ‌تر** (Soft Margin): مدل اجازه می‌دهد برخی نقاط در طرف اشتباه مرز قرار بگیرند
- **تحمل بیشتر برای خطاها**: نقاط نزدیک به مرز یا حتی در طرف اشتباه مجازات کمتری دارند
- **Generalization بهتر**: چون مدل بیش از حد به داده‌های آموزش وفادار نیست
- **ریسک Underfitting**: مدل ممکن است خیلی ساده باشد و الگوها را یاد نگیرد
- **بایاس بالا، واریانس پایین**

**C بزرگ (مثلاً 100):**
- **Margin کوچک‌تر** (Hard Margin): مدل سعی می‌کند همه نقاط را درست طبقه‌بندی کند
- **تحمل کمتر برای خطاها**: هر خطای طبقه‌بندی مجازات سنگینی دارد
- **دقت آموزش بالا**: مدل داده‌های آموزش را خیلی خوب یاد می‌گیرد
- **ریسک Overfitting**: مدل ممکن است به نویز و داده‌های پرت حساس شود
- **بایاس پایین، واریانس بالا**

**C بهینه:**
- تعادل بین Margin و دقت طبقه‌بندی
- بهترین Generalization روی داده‌های جدید
- نه Overfit و نه Underfit

---

### بهترین عملکرد مربوط به کدام حالت است؟ چرا؟

**بهترین حالت: Polynomial kernel با C=10**

**دلایل:**
1. **کرنل Polynomial**: می‌تواند روابط غیرخطی پیچیده‌تری نسبت به Linear مدل کند
2. **C=10**: مقدار متعادلی است که نه خیلی بزرگ است (Overfitting) و نه خیلی کوچک (Underfitting)
3. **درجه 3**: پیچیدگی کافی برای جداسازی کلاس‌های ارقام را فراهم می‌کند
4. **دیتاست Digits**: دارای ویژگی‌های با ابعاد بالا (64 ویژگی) است که SVM در آن عملکرد خوبی دارد

---

## جزئیات فنی

### SVM چیست؟
Support Vector Machine یک الگوریتم قدرتمند برای طبقه‌بندی است که:
- یک ابرصفحه (Hyperplane) برای جداسازی کلاس‌ها پیدا می‌کند
- سعی می‌کند حاشیه (Margin) بین کلاس‌ها را حداکثر کند
- از بردارهای پشتیبان (نقاط نزدیک به مرز) استفاده می‌کند

### کرنل‌ها
- **Linear**: `K(x, y) = x · y` - مناسب داده‌های خطی جدایی‌پذیر
- **Polynomial**: `K(x, y) = (x · y + c)^d` - برای روابط چندجمله‌ای
- **RBF**: `K(x, y) = exp(-γ||x - y||²)` - انعطاف‌پذیرترین کرنل

## خروجی‌های کد
- `svm_analysis.png`: مقایسه دقت کرنل‌ها
- `svm_confusion_matrices.png`: ماتریس درهم‌ریختگی

## نحوه اجرا
```bash
python svm_analysis.py
```
